function extend(e,t){for(var r in t)e[r]||(e[r]=t[r])}function toggleX(e){return 40*e+40}function toggleY(e){return 40*e+20}$(function(){var e=$("#cvs")[0].getContext("2d");new Chess(e)}),function(e){function t(e){this.ctx=e,this.drowBgc(),this.drowText(this.textArr),this.move()}extend(t.prototype,{textArr:{"red车1":["red","车",0,0],"red马1":["red","马",1,0],"red象1":["red","象",2,0],"red士1":["red","士",3,0],"red帅":["red","帅",4,0],"red士2":["red","士",5,0],"red象2":["red","象",6,0],"red马2":["red","马",7,0],"red车2":["red","车",8,0],"red炮1":["red","炮",1,2],"red炮2":["red","炮",7,2],"red兵1":["red","兵",0,3],"red兵2":["red","兵",2,3],"red兵3":["red","兵",4,3],"red兵4":["red","兵",6,3],"red兵5":["red","兵",8,3],"black车1":["black","車",0,9],"black马1":["black","马",1,9],"black象1":["black","象",2,9],"black士1":["black","士",3,9],"black帅":["black","将",4,9],"black士2":["black","士",5,9],"black象2":["black","象",6,9],"black马2":["black","马",7,9],"black车2":["black","車",8,9],"black炮1":["black","炮",1,7],"black炮2":["black","炮",7,7],"black兵1":["black","卒",0,6],"black兵2":["black","卒",2,6],"black兵3":["black","卒",4,6],"black兵4":["black","卒",6,6],"black兵5":["black","卒",8,6]},drowBgc:function(){for(var e=this.ctx,t=40,r=20,c=0;t<=360;c++)e.moveTo(t,r),e.lineTo(t,400-r),t+=40;e.stroke(),e.beginPath(),t=40,r=20;for(c=0;r<=380;c++)e.moveTo(t,r),e.lineTo(400-t,r),r+=40;e.stroke(),e.beginPath(),e.fillStyle="#dff0d8",e.fillRect(41,181,318,38),e.fill()},drowChess:function(e,t){this.ctx.arc(e,t,10,0,2*Math.PI),this.ctx.fillStyle="#dff0d8",this.ctx.strokeStyle="#000",this.ctx.fill(),this.ctx.stroke()},drowText:function(e){var t,r=this.ctx;for(t in e)r.beginPath(),this.drowChess(toggleX(e[t][2]),toggleY(e[t][3])),r.font="  15px Simsun,arial,sans-serif",r.strokeStyle=e[t][0],r.textAlign="center",r.textBaseline="middle",this.ctx.strokeText(e[t][1],toggleX(e[t][2]),toggleY(e[t][3]))},move:function(){var e=this;this.ctx.canvas.onclick=function(t){var r=e.textArr;for(every in r)r[every][2]==Math.round((t.offsetX-40)/40)&&r[every][3]==Math.round((t.offsetY-20)/40)&&(e.ctx.canvas.onclick=null,function(t){e.ctx.canvas.onclick=function(c){switch(r[t][1]){case"車":r[t][2]==Math.round((c.offsetX-40)/40)||r[t][3]==Math.round((c.offsetY-20)/40)?(r[t][2]=Math.round((c.offsetX-40)/40),r[t][3]=Math.round((c.offsetY-20)/40),e.ctx.canvas.onclick=null,e.ctx.fillRect(0,0,400,400),e.drowBgc(),e.drowText(r),e.move()):alert("注意规则")}}}(every))}}}),e.Chess=t}(window);